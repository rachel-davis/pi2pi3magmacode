p:=5;
AA<e0,e1>:=PolynomialRing(GF(p), 2);
IA:=ideal<AA|(e0-1)^p,(e1-1)^p>;
A<e0,e1>:=AA/IA;
y0:=e0-1;
y1:=e1-1;
E11:=1-e0^1-e1^1+e0*e1;
E12:=1-e0^1-e1^2+e0*e1^2;
E13:=1-e0^1-e1^3+e0*e1^3;
E14:=1-e0^1-e1^4+e0*e1^4;
E21:=1-e0^2-e1^1+e0^2*e1^1;
E22:=1-e0^2-e1^2+e0^2*e1^2;
E23:=1-e0^2-e1^3+e0^2*e1^3;
E24:=1-e0^2-e1^4+e0^2*e1^4;
E31:=1-e0^3-e1^1+e0^3*e1^1;
E32:=1-e0^3-e1^2+e0^3*e1^2;
E33:=1-e0^3-e1^3+e0^3*e1^3;
E34:=1-e0^3-e1^4+e0^3*e1^4;
E41:=1-e0^4-e1^1+e0^4*e1^1;
E42:=1-e0^4-e1^2+e0^4*e1^2;
E43:=1-e0^4-e1^3+e0^4*e1^3;
E44:=1-e0^4-e1^4+e0^4*e1^4;
one:=E11+E22+E33+E44-E21-E32-E43;
two:=E12+E23+E34-E21-E32-E43;
three:=E13+E24+E41-E21-E32-E43;
four:=E14+E31+E42-E21-E32-E43;
one eq one*e0*e1;
two eq two*e0*e1;
three eq three*e0*e1;
four eq four*e0*e1;
V25:=VectorSpace(GF(p), p^2);
function vec1(u)
y:=V25!0;
for i:=0 to p-1 do for j:=0 to p-1 do y[i*p+j+1]:=MonomialCoefficient(u,e0^i*e1^j); end for; end for;
return y;
end function;
h00:=V25![1,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1, 0,0,0,1];
h01:=V25![0,1,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, -1,0,0,1];
h02:=V25![0,0,1,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,-1,0,1];
h03:=V25![0,0,0,1,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,-1,1];
h10:=V25![0,0,0,0,0,1,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,-1, 0,0,0,1];
h11:=V25![0,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,0,0,0,0,0,0, -1,0,0,1];
h12:=V25![0,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0,0,0,0, 0,-1,0,1];
h13:=V25![0,0,0,0,0,0,0,0,1,-1,0,0,0,0,0,0,0,0,0,0,0, 0,0,-1,1];
h20:=V25![0,0,0,0,0,0,0,0,0,0,1,0,0,0,-1,0,0,0,0,0,-1, 0,0,0,1];
h21:=V25![0,0,0,0,0,0,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,0, -1,0,0,1];
h22:=V25![0,0,0,0,0,0,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,0, 0,-1,0,1];
h23:=V25![0,0,0,0,0,0,0,0,0,0,0,0,0,1,-1,0,0,0,0,0,0, 0,0,-1,1];
h30:=V25![0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,-1,-1, 0,0,0,1];
h31:=V25![0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,-1,0, -1,0,0,1];
h32:=V25![0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,-1,0, 0,-1,0,1];
h33:=V25![0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,-1,0, 0,0,-1,1];
H1:=sub<V25|h00,h01,h02,h03,h10,h11,h12,h13,h20,h21,h22,h23,h30,h31,h32,h33>;
g10:=vec1(e0^1*e1^0*(1-e0)*(1-e1));
g11:=vec1(e0^1*e1^1*(1-e0)*(1-e1));
g12:=vec1(e0^1*e1^2*(1-e0)*(1-e1));
g13:=vec1(e0^1*e1^3*(1-e0)*(1-e1));
g20:=vec1(e0^2*e1^0*(1-e0)*(1-e1));
g21:=vec1(e0^2*e1^1*(1-e0)*(1-e1));
g22:=vec1(e0^2*e1^2*(1-e0)*(1-e1));
g23:=vec1(e0^2*e1^3*(1-e0)*(1-e1));
g30:=vec1(e0^3*e1^0*(1-e0)*(1-e1));
g31:=vec1(e0^3*e1^1*(1-e0)*(1-e1));
g32:=vec1(e0^3*e1^2*(1-e0)*(1-e1));
g33:=vec1(e0^3*e1^3*(1-e0)*(1-e1));
H1:=VectorSpaceWithBasis([g10,g11,g12,g13,g20,g21,g22,g23,g30,g31,g32,g33,vec1(one), vec1(two), vec1(three), vec1(four)]);
Dimension(H1);
S:=sub<H1|vec1(one), vec1(two), vec1(three), vec1(four)>;
Q,q:=H1/S;
QQ:=VectorSpaceWithBasis([q(g10),q(g11),q(g12),q(g13),q(g20),q(g21),q(g22),q(g23), q(g30),q(g31),q(g32),q(g33)]);

function el(t)
elem:=0;
k:=0;
for i:=0 to 4 do for j:=0 to 4 do k:=k+1; elem:=elem+t[k]*e0^i*e1^j; 
 end for; end for;
 return elem;
 end function;
 p:=5;
M0:=Matrix(GF(p), 12, 12, [ 4, 1, 1, 0, 1, 4, 0, 0, 1, 0, 4, 0, 0, 4, 1, 1, 0, 1, 4, 0, 0, 1, 0, 4, 4, 4, 
3, 0, 0, 0, 1, 4, 1, 1, 2, 1, 0, 4, 4, 3, 1, 1, 1, 2, 4, 0, 0, 1, 0, 1, 0, 4, 0,
3, 3, 0, 1, 1, 2, 1, 1, 1, 2, 1, 0, 0, 3, 3, 4, 0, 0, 1, 4, 0, 0, 1, 2, 2, 2, 0,
4, 3, 4, 4, 4, 3, 4, 4, 0, 2, 2, 2, 1, 0, 4, 0, 4, 0, 0, 1, 3, 4, 4, 4, 4, 1, 1,
0, 4, 3, 4, 4, 1, 4, 0, 0, 0, 4, 1, 1, 1, 0, 4, 0, 0, 1, 4, 0, 4, 4, 3, 0, 0, 1,
0, 4, 0, 0, 1, 4, 0, 4, 4, 3 ]);
M1:=Matrix(GF(p), 12, 12, [ 3, 4, 2, 2, 2, 0, 2, 1, 1, 1, 1, 2, 3, 1, 2, 0, 4, 1, 4, 1, 3, 4, 4, 4, 0, 3, 
1, 2, 4, 3, 0, 3, 1, 4, 0, 0, 3, 3, 1, 4, 2, 1, 0, 2, 0, 1, 4, 0, 3, 4, 4, 4, 2,
2, 1, 1, 1, 4, 0, 0, 1, 4, 0, 0, 4, 1, 1, 0, 0, 1, 4, 0, 0, 1, 4, 0, 0, 4, 1, 1,
0, 0, 1, 4, 0, 0, 1, 4, 4, 4, 3, 0, 1, 1, 1, 2, 0, 1, 4, 0, 3, 0, 4, 3, 3, 4, 2,
2, 0, 0, 1, 4, 2, 0, 2, 1, 3, 1, 2, 0, 1, 1, 1, 2, 4, 1, 4, 1, 0, 3, 1, 2, 3, 4,
4, 4, 4, 3, 0, 3, 3, 3, 1, 4 ]);
M2:=Matrix(GF(p), 12, 12, [ 3, 4, 0, 4, 0, 4, 4, 2, 3, 2, 1, 4, 1, 4, 0, 1, 3, 3, 2, 2, 1, 4, 3, 2, 4, 0, 
3, 4, 3, 1, 1, 0, 3, 4, 2, 1, 1, 0, 1, 4, 0, 3, 1, 1, 4, 2, 3, 1, 1, 4, 3, 2, 2,
2, 0, 2, 3, 4, 2, 1, 3, 4, 2, 1, 3, 0, 0, 3, 4, 2, 3, 1, 4, 2, 3, 1, 2, 0, 2, 2,
4, 3, 1, 2, 4, 3, 1, 2, 3, 0, 3, 0, 3, 2, 1, 4, 4, 2, 3, 1, 4, 4, 2, 0, 3, 4, 0,
4, 4, 3, 1, 2, 0, 4, 4, 2, 1, 4, 0, 1, 3, 2, 1, 4, 3, 3, 2, 2, 4, 0, 3, 4, 1, 4,
3, 2, 3, 1, 1, 0, 1, 0, 1, 4 ]);
Me0:=Matrix(GF(p), 12, 12, [ 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1,
1, 0, 0, 1, 0, 0, 0, 1, 1, 4, 4, 0, 0, 0, 0, 0, 1, 4, 4, 4, 0, 0, 4, 4, 0, 4, 4,
4, 4, 0, 4, 4, 4, 0, 0, 4, 4 ]);
H1Q:=Kernel(M0-1) meet Kernel(M1-1) meet Kernel(M2-1); 
Me1:=Matrix(GF(p), 12, 12, [ 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 0, 0, 4, 4, 4, 4 ]);
Mt:=Matrix(GF(p), 12, 12, [ 0, 4, 4, 0, 0, 4, 4, 4, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 4, 4, 1,
1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1 ]);
Mtau:=Matrix(GF(p), 12, 12, [ 4, 4, 4, 4, 0, 4, 4, 4, 0, 0, 4, 4, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 4, 4, 4, 0, 0, 4, 4, 0, 0, 0, 4, 4, 1, 1, 0, 0,
0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 4, 4, 0, 0, 0, 4,
4, 0, 0, 4, 4, 4, 1, 0, 0, 0 ]);

Mtau:=Matrix(GF(5), 12, 12, [
0, 4, 4, 0, 0, 4, 4, 4, 1, 0, 0, 0,
0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1,
 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 4, 4, 1, 1, 0, 0, 0, 1, 0, 0,
0, 0, 1, 0, 0, 0, 1, 1, 4, 4, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
0, 0, 0, 0, 4, 4, 4, 4, 0, 0, 0, 0,
1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0,
0, 0, 0, 1, 4, 4, 4, 0, 0, 4, 4, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]);

Mrho2:=Matrix(GF(p),12,12, [ 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 
1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 4, 4, 4, 0, 4, 4, 4, 0, 0, 0,
0, 0, 1, 1, 0, 0, 1, 1, 0, 4, 4, 0, 0, 4, 4, 0, 0, 4, 4, 0,
0, 0, 0, 4, 4, 0, 0, 4, 4, 0, 0, 4, 4, 0, 1, 1, 1, 0, 1, 1,
1, 0, 1, 1, 1, 0, 4, 4, 0, 0, 4, 4, 0, 0, 4, 4, 0, 1, 1, 0,
0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0,
0, 0, 4, 4, 4, 0, 4, 4, 4, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1,
0, 0, 0, 0, 0 ]);

E0:=ExteriorSquare(M0);
E1:=ExteriorSquare(M1);
E2:=ExteriorSquare(M2);
Ee0:=ExteriorSquare(Me0);
Ee1:=ExteriorSquare(Me1);
Et:=ExteriorSquare(Mt);
Etau:=ExteriorSquare(Mtau);
Erho2:=ExteriorSquare(Mrho2);

K:=Kernel(E0-1) meet Kernel(E1-1) meet Kernel(E2-1) meet Kernel(Ee0-1) meet Kernel(Ee1-1) meet Kernel(Et-1);
K1:=Kernel(Etau-1);
U:=K meet K1;
